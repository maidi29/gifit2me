<ng-container *ngIf="activeRound?.situation; else waiting">
  <div *ngIf="!sent">Search a GIF for this situation:</div>
  <h2>{{activeRound?.situation}}</h2>

  <ng-container *ngIf="sent; else beforeSent">
    <ng-container *ngIf="!winner; else winnerDisplay">
      <ng-container *ngIf="(activeRound?.answers?.length || 0) < (players?.length || 1)-1; else answersGrid">
        <div>
          Wait until all Players have chosen a GIF and the Master starts revealing them
        </div>
      </ng-container>
      <ng-template #answersGrid>
        <div class="answers">
          <app-flip-card *ngFor="let answer of activeRound?.answers" [flipped]="activeRound?.flippedAnswers?.has(answer.playerName) ?? false">
            <img back [src]="answer.gifUrl" alt="" class="answerGif"/>
          </app-flip-card>
        </div>
      </ng-template>
    </ng-container>

    <ng-template #winnerDisplay>
      <app-round-winner [winnerGifUrl]="winner!.winnerGifUrl" [winnerName]="winner!.winnerName"></app-round-winner>
    </ng-template>
  </ng-container>

  <ng-template #beforeSent >
    <div class="search-input-container">
      <app-input [placeholder]="'Search'" [(ngModel)]="searchInput"></app-input>
      <app-button (click)="search(searchInput)">=></app-button>
    </div>

    <ngx-masonry [ordered]="true" class="masonry">
      <ng-container *ngIf="gifResultSrcs.length > 0">
        <div ngxMasonryItem class="masonry-item" *ngFor="let item of gifResultSrcs">
          <img masonryLazy src="{{item.small}}" class="gif" (click)="selectedGif = item" (load)="masonry?.layout()"/>
        </div>
      </ng-container>
    </ngx-masonry>
    <ng-container *ngIf="hasMoreResults">
      <app-button (click)="loadMore(searchInput)" class="load-more-button">Load more</app-button>
    </ng-container>
  </ng-template>

</ng-container>

<ng-template #waiting >
  <div class="info">
    Wait for master
  </div>
</ng-template>


<!--Modal-->
<div *ngIf="selectedGif" class="drop">
  <div class="modal">
    <div class="content">
      <img src="{{selectedGif.src}}"/>
      <app-button (click)="sendSelectedGif()">Send</app-button>
      <app-button [secondary]="true" (click)="selectedGif = undefined">Discard</app-button>
    </div>
  </div>
</div>

